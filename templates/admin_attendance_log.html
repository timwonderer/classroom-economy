<!DOCTYPE html>
<html>
<head>
    <title>Full Attendance Log</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 2rem;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .navbar {
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 220px;
            background-color: #f8f9fa;
            padding-top: 2rem;
            border-right: 1px solid #dee2e6;
        }
        .navbar .btn {
            width: 90%;
            margin: 0.5rem auto;
            display: block;
        }
        .main-content {
            margin-left: 240px;
        }
        .header {
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <h5 class="text-center mb-4">Admin Panel</h5>
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-primary">Dashboard</a>
        <a href="{{ url_for('admin_attendance_log') }}" class="btn btn-primary">Attendance Log</a>
        <a href="{{ url_for('admin_transaction_log') }}" class="btn btn-outline-primary">Transaction Log</a>
        <a href="{{ url_for('admin_students') }}" class="btn btn-outline-primary">Student Details</a>
        <a href="{{ url_for('admin_pass_management') }}" class="btn btn-outline-primary">Pass Management</a>
    </div>
    <div class="main-content">
<div class="header"><h2>Full Attendance Log</h2></div>
<a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-primary mb-3">← Back to Dashboard</a>

<p>Total logs: {{ logs|length }}</p>
<p>Total students: {{ students|length }}</p>

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Student</th>
            <th>Block</th>
            <th>Period</th>
            <th>Tap In</th>
            <th>Tap Out</th>
            <th>Duration</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        {% for log in logs %}
            <tr>
                <td>{{ students.get(log.student_id, {}).get('name', 'Unknown') }}</td>
                <td>{{ students.get(log.student_id, {}).get('block', '—') }}</td>
                <td>{{ log.period }}</td>
                <td>{{ log.tap_in_time.strftime("%Y-%m-%d %H:%M:%S") if log.tap_in_time else '—' }}</td>
                <td>{{ log.tap_out_time.strftime("%Y-%m-%d %H:%M:%S") if log.tap_out_time else '—' }}</td>
                <td>
                    {% if log.duration_seconds %}
                        {{ (log.duration_seconds // 60)|int }}m {{ (log.duration_seconds % 60)|int }}s
                    {% else %}
                        —
                    {% endif %}
                </td>
                <td>{{ log.reason or '—' }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
    </div> <!-- end main-content -->
</body>
</html>