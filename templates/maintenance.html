<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduled Maintenance</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
<style>
        :root {
            --gradient-start: #495892ff;
            --gradient-end: #2c1f41ff;
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --card-bg: #ffffff;
            --muted-bg: #f5f7fb;
        }

        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        body {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            font-family: Inter
        }

        .card {
            border: none;
            border-radius: 5px;
            padding: 2rem;
            max-width: 960px;
            width: 100%;
            overflow: hidden;
        }

        .card-header {
            background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0 1.75rem 1rem 1.75rem;
            
        }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            padding: 0.4rem 0.85rem;
            border-radius: 999px;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .card-body {
            padding: 0 1.75rem 0 1.75rem;
            background: var(--card-bg);
        }

        .lead {
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .text-secondary {
            color: var(--text-secondary) !important;
        }

        .icon-circle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: rgba(76, 111, 255, 0.12);
            color: var(--gradient-start);
            display: grid;
            place-items: center;
            font-size: 1.6rem;
        }

        .info-tile {
            background: var(--muted-bg);
            border-radius: 14px;
            padding: 1rem 1.25rem;
        }

        .list-group-item {
            border: none;
            padding: 0.75rem 0;
        }

        .footer-note {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .badge-container {
            margin-bottom: 1rem;
            border-radius: 5px;
            padding: 1rem;
            border-style: solid;
            border-width: 0 0 0 8px;
            color: #000000;
        }

        .badge-label {
            font-weight: 400;
            font-size: 12pt;
            color: #ffffff;
            padding: 3px 8px 3px 8px;
            width: fit-content;
            border-radius: 40px;
            text-align: center;
        }

        .badge-icon {
            font-size: 24px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center text-white" style="margin:0">
            <div>
                <div class="status-pill">
                    <span class="material-symbols-outlined" style="color: #1f306e; font-size:40px;vertical-align:-10%" aria-hidden="true">computer_cancel</span>
                    <span style="color: #1f306e;font-size:25pt;vertical-align:middle">Classrooom Token Hub <span style="font-weight:300">is currently unavailable</span></span>
                </div>
                <div style="border-radius: 5px; padding: 1rem; background-color: #fac0c0; border-style: solid; border-color: #a30303; border-width: 0 0 0 8px; margin-top: 1rem; color: #000000;">
                    <div style="font-weight: 400; font-size: 12pt; color: #ffffff; background-color: #a30303; padding: 3px 8px 3px 8px; width: fit-content; border-radius: 40px; text-align: center;">
                        <span class="material-symbols-outlined" style="font-size: 24px; vertical-align: -25%;" aria-hidden="true">error</span> IMPORTANT
                    </div>
                    <div style="margin-top: 0.5rem; margin-bottom: 0;">
                        Classroom Token Hub is an actively developing project. As such, this application may become temporarily unavailable when we detect an issue that could either degrade your experiences or compromise the integrity of our platform. <strong>Unfortunately, these events are often unpredictable and sudden.</strong><br><br>
                        We understand that having a reliable classroom economy application you can depend on is critical to your routines and we sincerely apologize for this inconvenience. We would like to thank you for your patience and continued support during this time.</div>          
                    </div>
            </div>
        </div>

        <div class="card-body">
            <div id="badge-container" class="badge-container">
                <div id="badge-label" class="badge-label">
                    <span id="badge-icon" class="material-symbols-outlined badge-icon" aria-hidden="true">apps_outage</span> <span id="badge-text">ABOUT THIS OUTAGE</span>
                </div>
                <div style="margin-top: 0.5rem; margin-bottom: 0;">{{ message or "We're applying updates and running database checks. Thank you for your patience!" }}</div>
            </div>
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <div class="info-tile h-100">
                        <div class="fw-semibold text-uppercase text-secondary" style="letter-spacing: 0.08em; font-size: 0.8rem;">Planned timeline</div>
                        <div class="fs-5 fw-bold mt-1">{{ expected_back or "We expect service to resume shortly." }}</div>
                        <p class="mb-0 text-secondary mt-1">Depending on the complexity of the issue, the actual time may be earlier or later than shown.</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="info-tile h-100">
                        <div class="fw-semibold text-uppercase text-secondary" style="letter-spacing: 0.08em; font-size: 0.8rem;">Need help?</div>
                        <p class="mb-0 text-secondary mt-1">If you need to report an urgent issue during this window, please contact us at <a href="mailto:timothy.cs.chang@gmail.com">timothy.cs.chang@gmail.com</a></p>
                    </div>
                </div>
            </div>

            <div class="row g-3 align-items-center mb-3">
                <div class="col-md-8">
                    
                </div>
                <div class="col-md-4 text-md-end text-center">
                    <button id="refreshButton" class="btn btn-primary px-4" type="button">Refresh Page</button>
                    <div class="footer-note mt-2">We'll retry automatically in <span id="countdown">60</span>s.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const countdownEl = document.getElementById('countdown');
        
        let seconds = 60;

        refreshButton?.addEventListener('click', () => window.location.reload());

        setInterval(() => {
            seconds = seconds - 1;
            if (seconds <= 0) {
                window.location.reload();
                return;
            }
            if (countdownEl) {
                countdownEl.textContent = seconds;
            }
        }, 1000);

        // Badge configuration
        const badgeConfig = {
            maintenance: {
                icon: 'construction',
                text: 'SCHEDULED MAINTENANCE',
                bgColor: '#ccdbff',
                borderColor: '#011c5c',
                labelBg: '#011c5c'
            },
            bug: {
                icon: 'bug_report',
                text: 'BUG FIX IN PROGRESS',
                bgColor: '#fff3cd',
                borderColor: '#856404',
                labelBg: '#856404'
            },
            security: {
                icon: 'shield',
                text: 'SECURITY PATCH',
                bgColor: '#f8d7da',
                borderColor: '#721c24',
                labelBg: '#721c24'
            },
            update: {
                icon: 'system_update',
                text: 'SYSTEM UPDATE',
                bgColor: '#d1ecf1',
                borderColor: '#0c5460',
                labelBg: '#0c5460'
            },
            feature: {
                icon: 'new_releases',
                text: 'NEW FEATURE DEPLOYMENT',
                bgColor: '#d4edda',
                borderColor: '#155724',
                labelBg: '#155724'
            },
            unavailable: {
                icon: 'cloud_off',
                text: 'SERVER UNAVAILABLE',
                bgColor: '#f8d7da',
                borderColor: '#721c24',
                labelBg: '#721c24'
            },
            error: {
                icon: 'error',
                text: 'UNEXPECTED ERROR',
                bgColor: '#f8d7da',
                borderColor: '#721c24',
                labelBg: '#721c24'
            }
        };

        // Apply badge styling
        const badgeType = {{ badge_type|default("maintenance")|tojson }};
        const config = badgeConfig[badgeType] || badgeConfig.maintenance;
        
        const badgeContainer = document.getElementById('badge-container');
        const badgeLabel = document.getElementById('badge-label');
        const badgeIcon = document.getElementById('badge-icon');
        const badgeText = document.getElementById('badge-text');
        
        if (badgeContainer && badgeLabel && badgeIcon && badgeText) {
            badgeContainer.style.backgroundColor = config.bgColor;
            badgeContainer.style.borderColor = config.borderColor;
            badgeLabel.style.backgroundColor = config.labelBg;
            badgeIcon.textContent = config.icon;
            badgeText.textContent = config.text;
        }
    </script>
</body>
</html>
