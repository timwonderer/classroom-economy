<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Teacher Login - Classroom Token Hub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ static_url('css/style.css') }}" rel="stylesheet">
    <style>
        body {
            background-color: #ebeced;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        .login-container {
            width: 100%;
            max-width: 900px;
            background: var(--surface);
            
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            display: flex;
            min-height: 600px;
        }
        .login-left {
            flex: 1;
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .login-right {
            flex: 1;
            background: linear-gradient(135deg, var(--primary), #004d46);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 3rem;
            position: relative;
            overflow: hidden;
        }
        .login-right::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .logo-img {
            width: 400px;
            height: 400px;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }
        .info-card {
            background: #fff7ec;
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            box-shadow: var(--shadow-sm);
        }
        .form-note {
            font-size: 0.9rem;
            color: var(--text-secondary-contrast);
        }
        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
                margin: 1rem;
                min-height: auto;
            }
            .login-right {
                display: none;
            }
            .login-left {
                padding: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-left">
            <div class="mb-4">
                <h1 class="h3 fw-bold mb-2" style="color:#1a4d47">Welcome back, Teachers!</h1>
                <p class="text-secondary">Please sign in to continue.</p>
            </div>

            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div class="alert alert-warning border-0 shadow-sm mb-4">
                        {{ messages[0] }}
                    </div>
                {% endif %}
            {% endwith %}

            <div class="info-card mb-4" style="border-radius:0;">
                <div class="d-flex align-items-start gap-2">
                    
                    <div>
                        <h6 class="fw-semibold " style="color:#1a4d47">Forget password? <span style="font-weight:300">Never.</span></h6>
                        <p class="mb-0 form-note">Teacher users use the 6-digit code from their authenticator app instead of passwords.</p>
                    </div>
                </div>
            </div>

            <form method="POST" id="loginForm">
                {{ form.hidden_tag() }}
                <div class="mb-3">
                    <label class="form-label small fw-bold  text-uppercase- text-secondary" >USERNAME</label>
                    {{ form.username(class="form-control form-control-lg") }}
                </div>
                <div class="mb-4">
                    <label class="form-label small fw-bold  text-uppercase text-secondary" >Authenticator Code</label>
                    {{ form.totp_code(class="form-control form-control-lg", inputmode="numeric", pattern="[0-9]*", maxlength="6") }}
                </div>

                {% if turnstile_site_key %}
                <div class="mb-4">
                    <div class="cf-turnstile" data-sitekey="{{ turnstile_site_key }}" data-theme="light"></div>
                </div>
                {% endif %}

                {{ form.submit(class="btn btn-primary w-100 btn-lg mb-4") }}

                <div class="text-center d-grid gap-2">
                    <a href="{{ url_for('admin.recover') }}" class="text-decoration-none small text-secondary">Forgot credentials? Recover account</a>
                    <a href="{{ url_for('admin.resume_credentials') }}" class="text-decoration-none small text-secondary">Resume recovery</a>
                    <a href="{{ url_for('student.login') }}" class="btn btn-outline-primary btn-sm mt-2">
                        
                        Student Login
                    </a>
                    <a href="{{ url_for('admin.signup') }}" class="btn btn-outline-secondary btn-sm">
                        
                        Set up teacher account
                    </a>
                </div>

                <div class="text-center mt-3 pt-3 border-top">
                    <a href="{{ url_for('main.privacy') }}" class="text-decoration-none small text-secondary me-3">Privacy</a>
                    <a href="{{ url_for('main.terms') }}" class="text-decoration-none small text-secondary">Terms</a>
                </div>
            </form>
        </div>
        <div class="login-right">
            <img src="{{ static_url('images/3_CLASSROOM TOKEN HUB TEACHER 512.png') }}" alt="Logo" class="logo-img">
        </div>
    </div>

    <!-- Loading Tips Modal -->
    <div class="modal fade" id="loadingTipsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-body text-center p-5">
                    <div class="spinner-border text-primary mb-4" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h5 class="fw-bold mb-3 text-primary">Pro Tip</h5>
                    <p class="text-secondary mb-0" id="tipText" style="min-height: 3rem; line-height: 1.6;">
                        Loading your dashboard...
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ static_url('js/loading_modal.js') }}"></script>
    <script>
        const teacherTips = [
            "Students don't have to stay logged in after starting work. They'll continue to earn minutes even when away from the page.",
            "Use the bulk transaction feature to quickly award or deduct tokens from multiple students.",
            "Set up automated payroll to save time on manual attendance tracking.",
            "The analytics dashboard shows spending trends to help you understand student behavior.",
            "Create custom store items to incentivize specific behaviors or achievements.",
            "Use insurance policies to teach students about risk management and financial protection.",
            "Rent settings can simulate monthly expenses to teach budgeting skills.",
            "Check the transaction log regularly to monitor unusual spending patterns.",
            "Bonus tokens are a great way to reward exceptional effort or good citizenship.",
            "Export your class data regularly for backup and analysis purposes."
        ];

        document.addEventListener('DOMContentLoaded', function() {
            initLoadingModal(teacherTips, {
                formId: 'loginForm',
                modalId: 'loadingTipsModal',
                tipTextId: 'tipText',
                minimumDisplayTime: 2500,
                rotationInterval: 4000
            });
        });
    </script>
</body>
</html>
