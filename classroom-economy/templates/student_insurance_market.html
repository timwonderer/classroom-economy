{% extends "layout_student.html" %}

{% block title %}Insurance Plans{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ›¡ï¸ Insurance Plans</h1>
    <p class="subtitle">Protect yourself with comprehensive coverage</p>
</div>

{% if cooldown_message %}
  <div class="alert alert-warning">{{ cooldown_message }}</div>
{% endif %}

{% if error_message %}
  <div class="alert alert-danger">{{ error_message }}</div>
{% endif %}

{% if student.insurance_plan and student.insurance_plan != 'none' %}
  <div class="card mb-4">
    <div class="card-header">
      Current Insurance
    </div>
    <div class="card-body">
      <h5 class="card-title">
        {% if student.insurance_plan == 'paycheck_protection' %}
          ğŸ’¼ Paycheck Protection
        {% elif student.insurance_plan == 'responsibility' %}
          ğŸ¤ Personal Responsibility
        {% elif student.insurance_plan == 'bundle' %}
          ğŸ“¦ Bundled Protection
        {% else %}
          {{ student.insurance_plan|title }}
        {% endif %}
      </h5>
      <p class="card-text text-muted">You are currently enrolled in this insurance plan.</p>
      <!-- Change Plan feature not yet implemented - cancel and re-purchase to change plans -->
      <!-- <a href="{{ url_for('student.student_insurance') }}" class="btn btn-outline-primary">Change Plan</a> -->
    </div>
  </div>
{% else %}
  <div class="row g-4">
    <!-- Paycheck Protection -->
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">ğŸ’¼ Paycheck Protection</h5>
        </div>
        <div class="card-body d-flex flex-column">
          <h3 class="text-primary mb-3">$90<small class="text-muted">/month</small></h3>
          <p class="flex-grow-1">Protects your earnings if you miss work due to valid circumstances.</p>
          <form action="{{ url_for('student.student_insurance') }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="insurance_type" value="paycheck_protection">
            <button type="submit" class="btn btn-primary w-100">Select Plan</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Personal Responsibility -->
    <div class="col-md-4">
      <div class="card h-100">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0">ğŸ¤ Personal Responsibility</h5>
        </div>
        <div class="card-body d-flex flex-column">
          <h3 class="text-success mb-3">$60<small class="text-muted">/month</small></h3>
          <p class="flex-grow-1">Coverage for responsibility-related incidents and penalties.</p>
          <form action="{{ url_for('student.student_insurance') }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="insurance_type" value="responsibility">
            <button type="submit" class="btn btn-success w-100">Select Plan</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Bundled Protection -->
    <div class="col-md-4">
      <div class="card h-100 border-warning">
        <div class="card-header bg-warning text-dark">
          <h5 class="mb-0">ğŸ“¦ Bundled Protection</h5>
          <small>Best Value!</small>
        </div>
        <div class="card-body d-flex flex-column">
          <h3 class="text-warning mb-3">$125<small class="text-muted">/month</small></h3>
          <p class="flex-grow-1">Complete coverage combining both Paycheck and Responsibility protection.</p>
          <form action="{{ url_for('student.student_insurance') }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="insurance_type" value="bundle">
            <button type="submit" class="btn btn-warning w-100">Select Plan</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="alert alert-info mt-4">
    <strong>â„¹ï¸ Note:</strong> Insurance premiums are charged monthly. Choose the plan that best fits your needs.
  </div>
{% endif %}
{% endblock %}
