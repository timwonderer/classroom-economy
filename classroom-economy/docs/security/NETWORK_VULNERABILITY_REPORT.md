# Network Infrastructure Vulnerability & Mitigation Strategy

**Scope:** The interaction between the DigitalOcean (DO) Droplet, Cloudflare, and the public internet.

### 1. IP Masking & Logging Blindness
*   **Vulnerability:** The application does not use `ProxyFix` middleware. Consequently, it treats the Cloudflare Proxy IP as the "client IP" for all requests.
*   **Risk:**
    *   **Forensic Blindness:** All application logs show Cloudflare IPs, making it impossible to identify or ban specific malicious attackers.
    *   **Security Degradation:** Cloudflare Turnstile receives the proxy IP instead of the user IP, reducing its ability to detect bots.
*   **Mitigation Strategy:**
    *   **Immediate Action:** Update `wsgi.py` to wrap the Flask app with `werkzeug.middleware.proxy_fix.ProxyFix`. Configure it to trust the `X-Forwarded-For` headers provided by Cloudflare.

### 2. Origin Server Exposure
*   **Vulnerability:** The DigitalOcean Droplet is likely accessible directly via its public IP address (port 80/443), bypassing Cloudflare.
*   **Risk:** Attackers can scan for the origin IP and launch direct attacks (DDoS, brute force) that bypass Cloudflare’s WAF and bot protections.
*   **Mitigation Strategy:**
    *   **Firewall Rules (UFW):** Configure the server's firewall (`ufw`) to **only** accept incoming HTTP/HTTPS traffic from Cloudflare’s published IP ranges. Drop all other traffic to ports 80/443.
    *   **Authenticated Origin Pulls:** Configure the web server (if using Nginx) to require a client certificate presented by Cloudflare.

### 3. SSL/TLS Configuration
*   **Vulnerability:** If the connection between Cloudflare and DigitalOcean is not secure (e.g., "Flexible" SSL), traffic is unencrypted for the last hop.
*   **Risk:** Man-in-the-Middle (MitM) attacks between Cloudflare and the origin.
*   **Mitigation Strategy:**
    *   **Strict SSL:** Set Cloudflare SSL mode to **"Full (Strict)"**. Install a valid Origin Certificate (generated by Cloudflare) on the DigitalOcean server to ensure end-to-end encryption.
